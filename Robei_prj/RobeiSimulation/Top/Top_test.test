<!DOCTYPE Robei>
<Module Type="testbench" Class="module" Height="645" Y="0" File="Current/Top_test.test" Include="" Color="#d3d3d3" Comment="" Width="912" X="0" Time_Scale="" Parent="0" Name="Top_test" Code="&#x9;    wire Tx_Done;    &#xa;&#x9;    wire uart_tx_t;&#x9;  &#xa;&#x9;&#x9;wire uart_tx_t;&#xa;&#x9;    assign uart_rx = uart_tx_t;&#xa;&#xa;&#x9;    &#x9;    &#xa;&#x9;    pullup PUP(LM75A_SCL);&#xa;&#x9;    pullup PUP(LM75A_SDA);&#xa;&#x9;    pullup PUP(MOTOR__sclk);&#xa;&#x9;    pullup PUP(MOTOR__sdat);&#xa;&#x9;    &#xa;&#x9;&#x9;initial Clk = 1;&#xa;&#x9;&#x9;always #10 Clk = ~Clk;&#x9;&#x9;&#xa;&#x9;&#x9;reg [79:0] test_data;&#xa;&#x9;&#xa;&#x9;&#x9;initial begin&#xa;&#x9;&#x9;   Rst_n = 0;&#xa;&#xa;&#x9;&#x9;   #201;&#xa;&#x9;&#x9;   Rst_n = 1;&#xa;&#x9;  &#x9;&#x9; #200;&#xa;&#x9;&#x9;   test_data = 80'h55_A5_00_00_11_00_00_00_00_F0;&#x9;&#x9;//模拟机械臂的指令&#x9;&#x9;   &#xa;&#x9;&#x9;   send_en = 1;&#xa;&#x9;&#x9;   #20;&#xa;&#x9;&#x9;   send_en = 0;&#xa;&#x9;&#x9;   @(posedge Top1.Top_Arm_Motor3.Arm4.Tx_Done);&#xa;&#xa;&#x9;&#x9;   #20;&#xa;&#x9;&#x9;   test_data = 80'h55_A5_68_04_35_05_06_07_08_F0;&#x9;&#x9;&#x9;&#x9;//模拟电机的指令&#xa;&#x9;&#x9;   send_en = 1;&#xa;&#x9;&#x9;   #20;&#xa;&#x9;&#x9;   send_en = 0;&#xa;&#xa;&#x9;&#x9;  @(posedge Top1.Top_Arm_Motor3.i2c_control_motor_plus3.RW_Done);&#xa;&#x9;&#x9;   #20;&#xa;&#xa;&#xa;&#xa;&#x9;&#x9;   $finish;&#xa;&#x9;&#x9;end&#xa;&#xa;&#xa;">
 <Module Type="model" Class="Top" Height="501" Y="45.8733" File="Current/Top.model" Include="" Color="#d3d3d3" Comment="" Width="524" X="338.858" Parameters="" Parent="Top_test" Name="Top1" Code="&#xa;&#xa;&#xa;">
  <Port Height="20" Y="0.145709" Function="" Color="#faebd7" Inout="input" Width="20" Datatype="wire" X="-0.0381679" Datasize="1" Connect="" Side="left" Parent="Top1" Name="Clk"/>
  <Port Height="20" Y="0.311377" Function="" Color="#00ffff" Inout="input" Width="20" Datatype="wire" X="-0.0381679" Datasize="1" Connect="" Side="left" Parent="Top1" Name="Rst_n"/>
  <Port Height="20" Y="0.477046" Function="" Color="#7fffd4" Inout="input" Width="20" Datatype="wire" X="-0.0381679" Datasize="1" Connect="" Side="left" Parent="Top1" Name="i_echo"/>
  <Port Height="20" Y="0.642715" Function="" Color="#f5f5dc" Inout="input" Width="20" Datatype="wire" X="-0.0381679" Datasize="1" Connect="" Side="left" Parent="Top1" Name="uart_rx"/>
  <Port Height="20" Y="0.0459082" Function="" Color="#ffe4c4" Inout="output" Width="20" Datatype="wire" X="0.961832" Datasize="1" Connect="" Side="right" Parent="Top1" Name="LCD_CLK"/>
  <Port Height="20" Y="0.111776" Function="" Color="#b8860b" Inout="output" Width="20" Datatype="wire" X="0.961832" Datasize="1" Connect="" Side="right" Parent="Top1" Name="MOSI"/>
  <Port Height="20" Y="0.177645" Function="" Color="#ffebcd" Inout="output" Width="20" Datatype="wire" X="0.961832" Datasize="1" Connect="" Side="right" Parent="Top1" Name="LCD_RES"/>
  <Port Height="20" Y="0.243513" Function="" Color="#0000ff" Inout="output" Width="20" Datatype="wire" X="0.961832" Datasize="1" Connect="" Side="right" Parent="Top1" Name="LCD_DC"/>
  <Port Height="20" Y="0.309381" Function="" Color="#8a2be2" Inout="output" Width="20" Datatype="wire" X="0.961832" Datasize="1" Connect="" Side="right" Parent="Top1" Name="LCD_BLK"/>
  <Port Height="20" Y="0.37525" Function="" Color="#deb887" Inout="output" Width="20" Datatype="wire" X="0.961832" Datasize="1" Connect="" Side="right" Parent="Top1" Name="arm_uart_tx"/>
  <Port Height="20" Y="0.441118" Function="" Color="#5f9ea0" Inout="output" Width="20" Datatype="wire" X="0.961832" Datasize="1" Connect="" Side="right" Parent="Top1" Name="Beeeee"/>
  <Port Height="20" Y="0.506986" Function="" Color="#7fff00" Inout="output" Width="20" Datatype="wire" X="0.961832" Datasize="1" Connect="" Side="right" Parent="Top1" Name="MOTOR__sclk"/>
  <Port Height="20" Y="0.572854" Function="" Color="#d2691e" Inout="inout" Width="20" Datatype="wire" X="0.961832" Datasize="1" Connect="" Side="right" Parent="Top1" Name="MOTOR_sdat"/>
  <Port Height="20" Y="0.638723" Function="" Color="#ff7f50" Inout="output" Width="20" Datatype="wire" X="0.961832" Datasize="1" Connect="" Side="right" Parent="Top1" Name="o_trig"/>
  <Port Height="20" Y="0.704591" Function="" Color="#ff7f50" Inout="output" Width="20" Datatype="wire" X="0.961832" Datasize="1" Connect="" Side="right" Parent="Top1" Name="LM75A_SCL"/>
  <Port Height="20" Y="0.770459" Function="" Color="#6495ed" Inout="inout" Width="20" Datatype="wire" X="0.961832" Datasize="1" Connect="" Side="right" Parent="Top1" Name="LM75A_SDA"/>
  <Port Height="20" Y="0.836327" Function="" Color="#fff8dc" Inout="output" Width="20" Datatype="wire" X="0.961832" Datasize="1" Connect="" Side="right" Parent="Top1" Name="ARM_TX_EN"/>
 </Module>
 <Module Type="model" Class="uart_data_tx" Height="160" Y="413.69" File="Current/uart_data_tx.model" Include="" Color="#d3d3d3" Comment="" Width="160" X="106.652" Parameters="" Parent="Top_test" Name="uart_data_tx2" Code="&#xa;&#x9;&#x9;parameter DATA_WIDTH = 80;&#xa;&#x9;&#x9;parameter MSB_FIRST = 1;&#xa;&#x9;&#xa;&#x9;&#x9;reg [DATA_WIDTH-1 : 0]data_r;         //这里得改&#xa;&#x9;&#xa;&#x9;&#x9;reg [7:0] data_byte;&#xa;&#x9;&#x9;reg byte_send_en;&#xa;&#x9;&#x9;wire byte_tx_done;&#xa;&#x9;&#xa;&#x9;&#x9;reg [8:0]cnt;&#xa;&#x9;&#x9;reg [1:0]state;&#xa;&#x9;&#x9;&#xa;&#x9;&#x9;localparam S0 = 0;&#x9;//等待发送请求&#xa;&#x9;&#x9;localparam S1 = 1;&#x9;//发起单字节数据发送&#xa;&#x9;&#x9;localparam S2 = 2;&#x9;//等待单字节数据发送完成&#xa;&#x9;&#x9;localparam S3 = 3;&#x9;//检查所有数据是否发送完成&#xa;&#x9;&#x9;&#xa;&#x9;&#x9;always@(posedge Clk or negedge Rst_n)&#xa;&#x9;&#x9;if(!Rst_n)begin&#xa;&#x9;&#x9;&#x9;data_byte &lt;= 0;&#xa;&#x9;&#x9;&#x9;byte_send_en &lt;= 0;&#xa;&#x9;&#x9;&#x9;state &lt;= S0;&#xa;&#x9;&#x9;&#x9;cnt &lt;= 0;&#xa;&#x9;&#x9;end&#xa;&#x9;&#x9;else begin&#xa;&#x9;&#x9;&#x9;case(state)&#xa;&#x9;&#x9;&#x9;&#x9;S0: &#xa;&#x9;&#x9;&#x9;&#x9;&#x9;begin&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;data_byte &lt;= 0;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cnt &lt;= 0;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Tx_Done &lt;= 0;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if(send_en)begin&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;state &lt;= S1;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;data_r &lt;= data;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;end&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else begin&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;state &lt;= S0;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;data_r &lt;= data_r;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;end&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;end&#xa;&#x9;&#x9;&#x9;&#x9;&#xa;&#x9;&#x9;&#x9;&#x9;S1:&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;begin&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;byte_send_en &lt;= 1;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if(MSB_FIRST == 1)begin&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;data_byte &lt;= data_r[DATA_WIDTH-1:DATA_WIDTH - 8];&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;data_r &lt;= data_r &lt;&lt; 8;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;end&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else begin&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;data_byte &lt;= data_r[7:0];&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;data_r &lt;= data_r >> 8;&#x9;&#x9;&#x9;&#x9;&#x9;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;end&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;state &lt;= S2;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;end&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#xa;&#x9;&#x9;&#x9;&#x9;S2:&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;begin&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;byte_send_en &lt;= 0;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;if(byte_tx_done)begin&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;state &lt;= S3;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cnt &lt;= cnt + 9'd8;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;end&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;state &lt;= S2;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;end&#xa;&#x9;&#x9;&#x9;&#x9;&#xa;&#x9;&#x9;&#x9;&#x9;S3:&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;if(cnt >= DATA_WIDTH)begin&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;state &lt;= S0;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;cnt &lt;= 0;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Tx_Done &lt;= 1;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;end&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;else begin&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;state &lt;= S1;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Tx_Done &lt;= 0;&#xa;&#x9;&#x9;&#x9;&#x9;&#x9;end&#xa;&#x9;&#x9;&#x9;&#x9;default:state &lt;= S0;&#xa;&#x9;&#x9;&#x9;endcase&#x9;&#xa;&#x9;&#x9;end&#xa;&#x9;&#xa;&#x9;&#xa;&#x9;&#xa;&#xa;&#xa;&#xa;&#xa;">
  <Port Height="20" Y="0.075" Function="" Color="#faebd7" Inout="input" Width="20" Datatype="wire" X="-0.125" Datasize="1" Connect="" Side="left" Parent="uart_data_tx2" Name="Clk"/>
  <Port Height="20" Y="0.2125" Function="" Color="#00ffff" Inout="input" Width="20" Datatype="wire" X="-0.125" Datasize="1" Connect="" Side="left" Parent="uart_data_tx2" Name="Rst_n"/>
  <Port Height="20" Y="0.35" Function="" Color="#7fffd4" Inout="input" Width="20" Datatype="wire" X="-0.125" Datasize="DATA_WIDTH - 1 : 0" Connect="test_data" Side="left" Parent="uart_data_tx2" Name="data"/>
  <Port Height="20" Y="0.4875" Function="" Color="#f0ffff" Inout="input" Width="20" Datatype="wire" X="-0.125" Datasize="1" Connect="send_en" Side="left" Parent="uart_data_tx2" Name="send_en"/>
  <Port Height="20" Y="0.625" Function="" Color="#f5f5dc" Inout="input" Width="20" Datatype="wire" X="-0.125" Datasize="3" Connect="3'd4" Side="left" Parent="uart_data_tx2" Name="Baud_Set"/>
  <Port Height="20" Y="0.1375" Function="" Color="#ffe4c4" Inout="output" Width="20" Datatype="wire" X="0.875" Datasize="1" Connect="uart_tx_t" Side="right" Parent="uart_data_tx2" Name="uart_tx"/>
  <Port Height="20" Y="0.3375" Function="" Color="#b8860b" Inout="output" Width="20" Datatype="reg" X="0.875" Datasize="1" Connect="Tx_Done" Side="right" Parent="uart_data_tx2" Name="Tx_Done"/>
  <Port Height="20" Y="0.5375" Function="" Color="#ffebcd" Inout="output" Width="20" Datatype="wire" X="0.875" Datasize="1" Connect=" " Side="right" Parent="uart_data_tx2" Name="uart_state"/>
 </Module>
 <Port Height="20" Y="0.150388" Function="" Color="#faebd7" Inout="input" Width="20" Datatype="reg" X="-0.0219298" Datasize="1" Side="left" Parent="Top_test" Name="Clk"/>
 <Port Height="20" Y="0.316279" Function="" Color="#00ffff" Inout="input" Width="20" Datatype="reg" X="-0.0219298" Datasize="1" Side="left" Parent="Top_test" Name="Rst_n"/>
 <Port Height="20" Y="0.482171" Function="" Color="#7fffd4" Inout="input" Width="20" Datatype="reg" X="-0.0219298" Datasize="1" Side="left" Parent="Top_test" Name="i_echo"/>
 <Port Height="20" Y="0.648062" Function="" Color="#f5f5dc" Inout="input" Width="20" Datatype="reg" X="-0.0219298" Datasize="1" Side="left" Parent="Top_test" Name="uart_rx"/>
 <Port Height="20" Y="0.0511628" Function="" Color="#ffe4c4" Inout="output" Width="20" Datatype="wire" X="0.97807" Datasize="1" Side="right" Parent="Top_test" Name="LCD_CLK"/>
 <Port Height="20" Y="0.117829" Function="" Color="#b8860b" Inout="output" Width="20" Datatype="wire" X="0.97807" Datasize="1" Side="right" Parent="Top_test" Name="MOSI"/>
 <Port Height="20" Y="0.184496" Function="" Color="#ffebcd" Inout="output" Width="20" Datatype="wire" X="0.97807" Datasize="1" Side="right" Parent="Top_test" Name="LCD_RES"/>
 <Port Height="20" Y="0.251163" Function="" Color="#0000ff" Inout="output" Width="20" Datatype="wire" X="0.97807" Datasize="1" Side="right" Parent="Top_test" Name="LCD_DC"/>
 <Port Height="20" Y="0.317829" Function="" Color="#8a2be2" Inout="output" Width="20" Datatype="wire" X="0.97807" Datasize="1" Side="right" Parent="Top_test" Name="LCD_BLK"/>
 <Port Height="20" Y="0.384496" Function="" Color="#deb887" Inout="output" Width="20" Datatype="wire" X="0.97807" Datasize="1" Side="right" Parent="Top_test" Name="arm_uart_tx"/>
 <Port Height="20" Y="0.451163" Function="" Color="#5f9ea0" Inout="output" Width="20" Datatype="wire" X="0.97807" Datasize="1" Side="right" Parent="Top_test" Name="Beeeee"/>
 <Port Height="20" Y="0.517829" Function="" Color="#7fff00" Inout="output" Width="20" Datatype="wire" X="0.97807" Datasize="1" Side="right" Parent="Top_test" Name="MOTOR__sclk"/>
 <Port Height="20" Y="0.584496" Function="" Color="#d2691e" Inout="inout" Width="20" Datatype="wire" X="0.97807" Datasize="1" Side="right" Parent="Top_test" Name="MOTOR_sdat"/>
 <Port Height="20" Y="0.651163" Function="" Color="#ff7f50" Inout="output" Width="20" Datatype="wire" X="0.97807" Datasize="1" Side="right" Parent="Top_test" Name="o_trig"/>
 <Port Height="20" Y="0.717829" Function="" Color="#ff7f50" Inout="output" Width="20" Datatype="wire" X="0.97807" Datasize="1" Side="right" Parent="Top_test" Name="LM75A_SCL"/>
 <Port Height="20" Y="0.784496" Function="" Color="#6495ed" Inout="inout" Width="20" Datatype="wire" X="0.97807" Datasize="1" Side="right" Parent="Top_test" Name="LM75A_SDA"/>
 <Port Height="20" Y="0.851163" Function="" Color="#fff8dc" Inout="output" Width="20" Datatype="wire" X="0.97807" Datasize="1" Side="right" Parent="Top_test" Name="ARM_TX_EN"/>
 <Wire To="Top_test#Top1>Clk" From="Top_test>Clk" Datatype="wire" Datasize="1" Parent="Top_test" Name="Top_test_Clk"/>
 <Wire To="Top_test#Top1>Rst_n" From="Top_test>Rst_n" Datatype="wire" Datasize="1" Parent="Top_test" Name="Top_test_Rst_n"/>
 <Wire To="Top_test#Top1>i_echo" From="Top_test>i_echo" Datatype="wire" Datasize="1" Parent="Top_test" Name="Top_test_i_echo"/>
 <Wire To="Top_test#Top1>uart_rx" From="Top_test>uart_rx" Datatype="wire" Datasize="1" Parent="Top_test" Name="Top_test_uart_rx"/>
 <Wire To="Top_test>LCD_CLK" From="Top_test#Top1>LCD_CLK" Datatype="wire" Datasize="1" Parent="Top_test" Name="Top1_LCD_CLK"/>
 <Wire To="Top_test>MOSI" From="Top_test#Top1>MOSI" Datatype="wire" Datasize="1" Parent="Top_test" Name="Top1_MOSI"/>
 <Wire To="Top_test>LCD_RES" From="Top_test#Top1>LCD_RES" Datatype="wire" Datasize="1" Parent="Top_test" Name="Top1_LCD_RES"/>
 <Wire To="Top_test>LCD_DC" From="Top_test#Top1>LCD_DC" Datatype="wire" Datasize="1" Parent="Top_test" Name="Top1_LCD_DC"/>
 <Wire To="Top_test>LCD_BLK" From="Top_test#Top1>LCD_BLK" Datatype="wire" Datasize="1" Parent="Top_test" Name="Top1_LCD_BLK"/>
 <Wire To="Top_test>arm_uart_tx" From="Top_test#Top1>arm_uart_tx" Datatype="wire" Datasize="1" Parent="Top_test" Name="Top1_arm_uart_tx"/>
 <Wire To="Top_test>Beeeee" From="Top_test#Top1>Beeeee" Datatype="wire" Datasize="1" Parent="Top_test" Name="Top1_Beeeee"/>
 <Wire To="Top_test>MOTOR__sclk" From="Top_test#Top1>MOTOR__sclk" Datatype="wire" Datasize="1" Parent="Top_test" Name="Top1_MOTOR__sclk"/>
 <Wire To="Top_test>MOTOR_sdat" From="Top_test#Top1>MOTOR_sdat" Datatype="wire" Datasize="1" Parent="Top_test" Name="Top1_MOTOR_sdat"/>
 <Wire To="Top_test>o_trig" From="Top_test#Top1>o_trig" Datatype="wire" Datasize="1" Parent="Top_test" Name="Top1_o_trig"/>
 <Wire To="Top_test>LM75A_SCL" From="Top_test#Top1>LM75A_SCL" Datatype="wire" Datasize="1" Parent="Top_test" Name="Top1_LM75A_SCL"/>
 <Wire To="Top_test>LM75A_SDA" From="Top_test#Top1>LM75A_SDA" Datatype="wire" Datasize="1" Parent="Top_test" Name="Top1_LM75A_SDA"/>
 <Wire To="Top_test>ARM_TX_EN" From="Top_test#Top1>ARM_TX_EN" Datatype="wire" Datasize="1" Parent="Top_test" Name="Top1_ARM_TX_EN"/>
 <Wire To="Top_test#uart_data_tx2>Clk" From="Top_test>Clk" Datatype="wire" Datasize="1" Parent="Top_test" Name="Top_test_Clk"/>
 <Wire To="Top_test#uart_data_tx2>Rst_n" From="Top_test>Rst_n" Datatype="wire" Datasize="1" Parent="Top_test" Name="Top_test_Rst_n"/>
</Module>
