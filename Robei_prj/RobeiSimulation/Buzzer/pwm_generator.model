<!DOCTYPE Robei>
<Module Height="600" Comment="" Code="&#xa;&#x9;&#xa;&#x9;&#xa;&#x9;&#x9;reg [31:0]pwm_gen_cnt;   //定义32位产生pwm的计数器&#xa;&#x9;&#xa;&#x9;&#x9;always@(posedge Clk or posedge Rst_n)&#xa;&#x9;&#x9;if(!Rst_n )&#xa;&#x9;&#x9;&#x9;pwm_gen_cnt &lt;= 32'd1;&#xa;&#x9;&#x9;else if(pwm_gen_en)&#xa;&#x9;&#x9;begin&#xa;&#x9;&#x9;&#x9;if(pwm_gen_cnt &lt;= 32'd1)&#xa;&#x9;&#x9;&#x9;&#x9;pwm_gen_cnt &lt;= counter_arr;       //计数减到1，加载预重装寄存器值&#xa;&#x9;&#x9;&#x9;else&#xa;&#x9;&#x9;&#x9;&#x9;pwm_gen_cnt &lt;= pwm_gen_cnt - 1'b1;//计数器自减1&#xa;&#x9;&#x9;end&#xa;&#x9;&#x9;else&#xa;&#x9;&#x9;&#x9;pwm_gen_cnt &lt;= counter_arr;&#x9;        //未使能时，计数器值等于预重装寄存器值&#xa;&#x9;&#xa;&#x9;&#x9;always@(posedge Clk or posedge Rst_n)&#xa;&#x9;&#x9;if(!Rst_n )                          //复位时，PWM输出低电平&#xa;&#x9;&#x9;&#x9;pwm_out &lt;= 1'b0;&#xa;&#x9;&#x9;else if(pwm_gen_cnt &lt;= counter_ccr)   //计数值小于比较值，PWM输出高电平&#xa;&#x9;&#x9;&#x9;pwm_out &lt;= 1'b1;&#xa;&#x9;&#x9;else&#xa;&#x9;&#x9;&#x9;pwm_out &lt;= 1'b0;                    //计数值大于比较值，PWM输出低电平" Class="module" X="0" Y="0" Color="#d3d3d3" Include="" File="Current/pwm_generator.model" Parameters="" Name="pwm_generator" Width="900" Parent="0" Type="module">
 <Port Height="20" Function="" X="-0.0222222" Side="left" Y="0.125" Datatype="wire" Inout="input" Color="#faebd7" Name="Clk" Width="20" Datasize="1" Parent="pwm_generator"/>
 <Port Height="20" Function="" X="-0.0222222" Side="left" Y="0.266667" Datatype="wire" Inout="input" Color="#00ffff" Name="Rst_n" Width="20" Datasize="1" Parent="pwm_generator"/>
 <Port Height="20" Function="" X="-0.0222222" Side="left" Y="0.408333" Datatype="wire" Inout="input" Color="#7fffd4" Name="pwm_gen_en" Width="20" Datasize="1" Parent="pwm_generator"/>
 <Port Height="20" Function="" X="-0.0222222" Side="left" Y="0.55" Datatype="wire" Inout="input" Color="#f0ffff" Name="counter_arr" Width="20" Datasize="32" Parent="pwm_generator"/>
 <Port Height="20" Function="" X="-0.0222222" Side="left" Y="0.691667" Datatype="wire" Inout="input" Color="#f5f5dc" Name="counter_ccr" Width="20" Datasize="32" Parent="pwm_generator"/>
 <Port Height="20" Function="" X="0.977778" Side="right" Y="0.316667" Datatype="reg" Inout="output" Color="#ffe4c4" Name="pwm_out" Width="20" Datasize="1" Parent="pwm_generator"/>
</Module>
